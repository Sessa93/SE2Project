1) Introduction

  - Purpose
    This document represents the Design Document(DD).
    The purpose of the Design Document is to provide a medium/base level description of the design of MyTaxiService
    in order to allow for software developers to proceed with an understanding of what is to be
    built and how it is expected to be built.
    The main goal of this document is to completely describe the system-to-be by:
      - Detecting high-level components of the software to be
      - Describing how these components communicate and interact with each other
      - Describing how software components are distributed on the architecture's tiers
      - Motivating and describing the adopted architectural style

  - Scope
    The aim of this project is to develop MyTaxiService, a web/mobile application that
    makes easier and quicker taking taxies within the city’s borders. Thanks to MyTaxiService,
    anyone can request or book a taxi and get realtime information about how long
    it will take to be picked up or about the taxi’s current position and identification code.
    In addition to that, MyTaxiService provides an efficient way to allocate taxies by dividing
    the city in zones and using a queue based allocation system, in order to reduce the
    average waiting time and city’s traffic.
    This Software Design is focused on the base level system and critical parts
    of the system.

  - Terms Definition
    - Glossary
        Tier: Refers to a possible hardware level in a generic architecture style
        Layer: Refers to a possible software level in generic software application

    - Acronyms
        DD: Design Document
        MVC: Model View Controller
        FIFO: First In First Out
        API: Application Programming Interface
        GUI: Graphic User Interface
        GPS: Global Positioning System

  - Reference Documents
    - RASD v1.1

  - Document Structure
    - Introduction
      This section provides a general description of the Design Document by clearly stating purpose an aim of the project.
      It also includes a disambiguation section to help the reader in the process of resolving the ambiguity generated by
      the use of natural language

    - Architecture Design
      The first part of this section provides a detailed description of the high-level components of MyTaxiService and of how
      these components interact.
      The second part introduces the architectural style chosen for MyTaxiService. The focus is on motivation, advantages and possible
      disadvantages of the chosen architecture.

    - Algorithms Design
      The section aims to provide a very medium/low level description of some routine functionalities of MyTaxiService.
      Some code is included.

    - User Interface Design
      In this section are provided some mockups describing the requirements of the user interface to-be

    - Requirements Traceability
      This section provides a matrix of traceability that allows the reader to map functional requirements on the
      previously defined software components

2 - Architectural Design

  - Overview
      The architectural design section is divided into two main parts:
        - Software components description and interaction
            In this section is provided a detailed description of the main components of the software system
            and of their interactions.
            To exemplify the above mentioned description a set of UML diagrams(Component, Deployment, Sequence diagrams) is
            included.
        - Architectural styles and patterns
            In this section the software system architecture is illustrated using a schematic diagram.
            In addition to that all the architectural choices, patterns and styles considered are motivated and described.

  - High level components and their interactions
      Controller Components:
        - Dispatcher:
            This component provides the functionality of dispatching messages from MyTaxiService(B) to users and mtaxies.
            Examples of these messages are :
            - for users : aproximate waiting time for being picked up, the requested mtaxi's identification code
            - for mtaxies : zone change order, new ride request

        - Request Manager:
            This component is in charge of:
            - managing all types of requests coming from the Requests Receiver(this requires an
            interaction with the User Messages Dispatcher, the Taxi Messages Dispatcher, the Queue Manager, the
            Location Manager and the Data Manager)
            - managing a situation of non fair distribution of mtaxies in the city's zones(this requires an interaction
            with the Queue Manager)

        - External Communication manager:
            This component is in charge of the interaction of MyTaxiService(B) with external services such as
            the traffic information service or the mtaxies GPS data and allows other components to access these pieces of information.


        - Location Manager
            This component requests and digests data from the External Communication Manager; the Location Manager
            provides also services that elaborate these data and make them accessible by other components

        - Queue Manager:
            This component is in charge of:
            - distributing available mtaxies in city's zones and organize them in zone per zone queues
            - checking periodically if the distribution of mtaxies in city's zones is fair and computing the mtaxies
            that need to be moved to other zones

        - Request Receiver:
            This component manages incoming messages from users and mtaxies.
            According to the type of message, the request receiver will properly invoke services provided by the Request Manager.

      Model Components
        - Data Manager:
            This component is in charge of managing all accesses to the database system. It works as a sort of
            intermediate layer between the application logic and the database system

      View Components:
        - MyTaxiServiceAppUserGUI:
            This component manages the direct interaction between a user and MyTaxiService via the MyTaxiService mobile app GUI
        - MyTaxiServiceAppDriverGUI:
            This component manages the direct interaction between a mtaxi driver and MyTaxiService via the MYT device GUI
        - MyTaxiServiceWebUserGUI:
            This component manages the direct interaction between a user and a taxi driver and MyTaxiService via the MyTaxiService web app GUI

        For each of these view components a communication manager is associated: this component manages the dispatching of requests to MyTaxiService(b)
        and the response messages from MyTaxiService(b)

    - Components Interfaces
      See the component diagram in component view section for a schematic representation
      - Request Receiver
          This component interfaces itself with presentation layer with two main interfaces; the first is to receive and
          process data relative to users requests and the second is to receive and process mtaxi requests.
          The request receiver directly communicates with the request manager component by means of two interfaces one dedicated
          to business requests and the second dedicated to other requests.
          All messages are exchanged in synchronous way on both side.

      - Request Manager
          This components interfaces itself with all the components contained in the controller module.
          In general it offers to the others components the functionality to store data, notifies users and to manage users request.
          To accomplish its tasks the component requires data coming from the Queue Manager and Location Manager
          In particular it communicates with:
            - Location Manager: via the Approx Waiting Time interface(synchronous)
            - Queue Manager: via three interfaces:
                - TaxiByZone: synchronous, get the set of taxies in the given zone
                - NonFairDistribution: asynchronous, used in case the Queue manager detects a non fair distribution of taxies among queues
                - RemoveFromQueue: asynchronous, to remove a taxi from a queue
            - Dispatcher: via two synchronous interfaces used to notify mtaxi and users
            - Data Manager: via three synchronous interfaces in order to store data relative to users, mtaxies and information about requests

       - Data Manager
          This component from one side communicates

    - Architecture Styles Description
        Some general considerations on the domain of the environment:
          - The number of available mtaxies within the city could be very high(ie a thousand of mtaxies).
          - The number of requests by active users could also be very high typically in the order of the available mtaxies.
        Due to those simple considerations the chosen architecture style is a 3 tiers Client/Server architecture.
        The Client/Server architectures is used to manage all types of critical requests(booking/ride requests, login, registration and ) coming from the users of MyTaxiService(drivers and passenger).
        Such an architecture introduce a sort of synchronization between the central system and the clients of the system.
        This synchronization guarantees to the clients that all requests are correctly received and stored by the central system.
        Also due to the possible high number of requests coming from users this particular style reveals to be very scalable and reliable.

        Mtaxi drivers are notified by the system by means of a "polling" technique:
        The MYT device periodically queries the central system about new messages for the mtaxi driver, if some messages are present
        the the MYT device will present them to the driver via a suitable visualization.

        The client/server styles, as stated above, is a typical 3-tier architecture composed by:
          - One web server hosting the web ui interface of MyTaxiService and three client gui: passengers, mtaxi driver and system administrator
          - One or more application server(in order to guarantee the availabilty/relaiabilty of the system) hosting
            the core logic of MyTaxiService, this tier also includes the servers needed to implements the Event Based styles
          - A distributed database system to store the informations related to users and mtaxi drivers.

        The client in this architecture is a "thin" client, it just contains only an interaction/visualization layer, all
        the logic of the application is condensed in the server side of the architecture, so the server can be considered
        a "fat" server.

        The number of each server in each tier could be greater than one. In this case each tier can be seen as distributed
        interconnection of servers. Very useful to manage in a flexible way a high number of request(and connection) coming
        from the external environment.

        Security Considerations:
          The selected architecture styles also guarantee a flexible management of security issues.
          Indeed the organization of the server side of the architecture guarantees a strong division
          between the data and the logic of the application. All zones within the architecture are divided
          by means of a firewall which restricts users access in order to prevent maliciuos users to access
          criticals zones of the server side.

        Follows a schematic diagram of the architecture:

        TODO GIORGIO

        As already mentioned above the central system makes use of external service regarding the traffic information in the
        city. It could be assumed that information are distributed to MyTaxiService via a SOA architecture because this is
        the most suitable(and most used) way to distribute data and services to external companies.
